<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Detail Produk</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: #faf7f2;
        padding-bottom: 80px;
      }

      footer {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: #fff;
        border-top: 1px solid #dcdcdc;
        padding: 12px 0;
        text-align: center;
        z-index: 99;
      }

      .thumb-img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        border-radius: 10px;
        cursor: pointer;
        border: 2px solid transparent;
        transition: 0.2s;
      }

      .thumb-img:hover {
        border-color: #1a8f5a;
      }

      .size-btn {
        padding: 8px 14px;
        border: 2px solid #6f452a;
        border-radius: 10px;
        font-size: 14px;
        cursor: pointer;
        color: #6f452a;
        font-weight: 600;
        transition: 0.25s ease;
      }

      .size-btn:hover,
      .size-btn.active {
        background: #6f452a;
        color: white;
      }

      .btn-buy {
        background: #6f452a;
        color: white;
        font-weight: 600;
        border-radius: 8px;
        padding: 10px 20px;
        transition: 0.25s ease;
      }

      .btn-buy:hover {
        background: #54321f;
        color: white;
        transform: translateY(-2px);
      }
    </style>
  </head>

  <body>
    <div class="container py-5">
      <button class="btn btn-outline-dark mb-4" onclick="history.go(-1)">
        ← Kembali
      </button>

      <div id="detail-container" class="row g-5"></div>
    </div>

    <footer>
      <p>&copy; 2023 Toko Baju Minimalis. Semua hak dilindungi.</p>
    </footer>

    <script>
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      const urlParams = new URLSearchParams(window.location.search);
      const produkId = urlParams.get("id");

      fetch("produk.json")
        .then((res) => res.json())
        .then((data) => {
          const produk = data.find((item) => item.id === produkId);

          if (!produk) {
            document.getElementById("detail-container").innerHTML =
              "<h3>Produk tidak ditemukan.</h3>";
            return;
          }

          document.getElementById("detail-container").innerHTML = `
            <div class="col-md-6 text-center">
              <img id="main-image"
                src="${produk.gambar}"
                class="img-fluid shadow rounded"
                style="max-height: 380px; object-fit: cover;"
              >

              <div class="d-flex justify-content-center gap-3 mt-3">
                <img src="${
                  produk.gambar
                }" class="thumb-img" onclick="changeImage(this.src)">
                <img src="${
                  produk.gambar
                }" class="thumb-img" onclick="changeImage(this.src)">
                <img src="${
                  produk.gambar
                }" class="thumb-img" onclick="changeImage(this.src)">
              </div>
            </div>

            <div class="col-md-6">
              <p class="text-success fw-bold mb-1">Stok Tersedia</p>

              <h2 class="fw-bold">${produk.nama}</h2>

              <div class="d-flex align-items-center gap-2 mb-2">
                <span class="text-warning fs-5">★★★★★</span>
                <span class="text-muted">(245 Review)</span>
              </div>

              <h3 class="text-danger fw-bold">Rp ${produk.harga.toLocaleString()}</h3>

              <button class="btn btn-warning w-100 fw-semibold mb-3"
                      onclick="addToCart('${produk.id}')">
                + Tambah ke Keranjang
              </button>

              <p class="text-success fw-bold mb-1">
                Stok: <span id="stock-${produk.id}">${produk.stok || 10}</span>
              </p>

              <p class="text-muted mb-3">${produk.deskripsi}</p>

              <h6 class="fw-bold mt-3">Pilih Ukuran:</h6>

              <div class="d-flex gap-2 flex-wrap mb-4">
                <span class="size-btn active">30 ml</span>
                <span class="size-btn">60 ml</span>
                <span class="size-btn">80 ml</span>
                <span class="size-btn">100 ml</span>
              </div>

              <div class="w-100 d-flex justify-content-center mt-4">
                <a
                  href="https://wa.me/1234567890?text=Saya%20ingin%20beli%20Produk"
                  target="_blank"
                  class="btn btn-buy px-4 py-2 w-100"
                  style="max-width: 260px; text-align:center;"
                >
                  Buy Now
                </a>
              </div>

              <p class="text-muted">Tags : ${(produk.tags || []).join(", ")}</p>
            </div>
          `;

          document.querySelectorAll(".size-btn").forEach((btn) => {
            btn.addEventListener("click", function () {
              document
                .querySelectorAll(".size-btn")
                .forEach((b) => b.classList.remove("active"));
              this.classList.add("active");
            });
          });
        });

      function changeImage(src) {
        document.getElementById("main-image").src = src;
      }

      function addToCart(id) {
        cart.push({ id: id });
        localStorage.setItem("cart", JSON.stringify(cart));
        alert("Produk berhasil ditambahkan ke keranjang!");
      }
    </script>
  </body>
</html>
